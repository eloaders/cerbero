' Gambas class file

Public RADIVATE As Collection
Public USER_DATA As Collection
Public Sub PrintValidateData()
  
  Dim RADIVATE As Collection
  Dim VALIDATE_ID As String
  Dim DWDATE As String
  Dim Flags As String[]
  Dim OneFlag As String
  Dim i As Integer
  DWDATE = Replace(Request.Get["validate2"], Right$(Request.Get["validate2"], -8), "")
  
  If Exist(Global.WHEREIS_SITE_ROOT & "/ValidDB/" & DWDATE & "/" & Right$(Request.Get["validate2"], -8) & ".json") = True Then
    RADIVATE = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/ValidDB/" & DWDATE & "/" & Right$(Request.Get["validate2"], -8) & ".json"))
        
        If Error Then
            Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & "/inex.r?fail")
        Endif
    
    VALIDATE_ID = Request.Get["validate2"]
  


  If IsNull(RADIVATE["SUBMITED_BY"]) = False Then
    If Exist(Global.WHEREIS_SITE_ROOT & "/Users/" & RADIVATE["SUBMITED_BY"] & "") Then
      USER_DATA = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/Users/" & RADIVATE["SUBMITED_BY"] & "/Data.json"))
    Endif
  Endif
  Response.Begin
  WValidate.Render
  Response.End
  Else
      Response.Begin
      Errors.Valid_Not_Found()
      Response.End
  Endif
End

Public Function USER_DATAR(var As String) As String
  
  Return USER_DATA[var]
  
End
