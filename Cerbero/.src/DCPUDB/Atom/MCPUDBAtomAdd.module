' Gambas module file

Public Sub Add()
  Dim CPUDBATOM As Collection
  Dim CPUDBATOMADD As Collection = [("VALD"): (Rnd(200))]
  If Usera.User_Logged() = True And Usera.User_IsAdmin() = True Then
  CPUDBATOM = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/CPUDB/atom"))
  
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_MODEL_NAME"], "PROCESSOR_MODEL_NAME")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_SOCKET_IMAGE"], "PROCESSOR_SOCKET_IMAGE")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_SOCKET"], "PROCESSOR_SOCKET")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_PROCESS_SIZE"], "PROCESSOR_PROCESS_SIZE")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_TRANSISTORS"], "PROCESSOR_TRANSISTORS")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_DIE_SIZE"], "PROCESSOR_DIE_SIZE")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_PACKAGE"], "PROCESSOR_PACKAGE")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_TCASEMAX"], "PROCESSOR_TCASEMAX")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_FREQUENCY"], "PROCESSOR_FREQUENCY")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_TURBOCLOCK"], "PROCESSOR_TURBOCLOCK")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_MULTIPLIER"], "PROCESSOR_MULTIPLIER")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_VOLTAGE"], "PROCESSOR_VOLTAGE")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_TDP"], "PROCESSOR_TDP")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_CODENAME"], "PROCESSOR_CODENAME")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_PART"], "PROCESSOR_PART")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_PRODUCTION_STATUS"], "PROCESSOR_PRODUCTION_STATUS")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_RELEASED"], "PROCESSOR_RELEASED")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_MEMORYSUPPORT"], "PROCESSOR_MEMORYSUPPORT")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_OFCORES"], "PROCESSOR_OFCORES")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_SMPCPUS"], "PROCESSOR_SMPCPUS")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_INTEGRATEDGRAPHIC"], "PROCESSOR_INTEGRATEDGRAPHIC")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_CACHEL1"], "PROCESSOR_CACHEL1")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_CACHEL2"], "PROCESSOR_CACHEL2")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_CACHEL3"], "PROCESSOR_CACHEL3")
  CPUDBATOMADD.Add(Request.Post["PROCESSOR_MARKET"], "PROCESSOR_MARKET")
  CPUDBATOMADD.Remove("VALD")
  CPUDBATOM["DATABASE"].Add(CPUDBATOMADD)
  
  File.Save(Global.WHEREIS_SITE_ROOT & "/CPUDB/atom", JSON.Encode(CPUDBATOM))
  Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root & "?cpudb[atom]edit=" & CString(CPUDBATOM["DATABASE"].Count - 1) & "")
  Else
    Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root)
  Endif
  
End
