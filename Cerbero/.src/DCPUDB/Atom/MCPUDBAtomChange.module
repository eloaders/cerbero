' Gambas module file

Public Sub Change()
  Dim CPUDBATOM As Collection
  Dim ID As Integer = Request.Post["ID"]
  If Usera.User_Logged() = True And Usera.User_IsAdmin() = True Then
  CPUDBATOM = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/CPUDB/atom"))
  
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_MODEL_NAME"] = Request.Post["PROCESSOR_MODEL_NAME"]
  If Request.Post["PROCESSOR_SOCKET_IMAGE"] = "0.gif" Then
    CPUDBATOM["DATABASE"][ID]["PROCESSOR_SOCKET_IMAGE"] = CPUDBATOM["DATABASE"][ID]["PROCESSOR_SOCKET_IMAGE"]
  Else
    CPUDBATOM["DATABASE"][ID]["PROCESSOR_SOCKET_IMAGE"] = Request.Post["PROCESSOR_SOCKET_IMAGE"]
  Endif
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_SOCKET"] = Request.Post["PROCESSOR_SOCKET"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_PROCESS_SIZE"] = Request.Post["PROCESSOR_PROCESS_SIZE"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_TRANSISTORS"] = Request.Post["PROCESSOR_TRANSISTORS"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_DIE_SIZE"] = Request.Post["PROCESSOR_DIE_SIZE"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_PACKAGE"] = Request.Post["PROCESSOR_PACKAGE"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_TCASEMAX"] = Request.Post["PROCESSOR_TCASEMAX"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_FREQUENCY"] = Request.Post["PROCESSOR_FREQUENCY"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_TURBOCLOCK"] = Request.Post["PROCESSOR_TURBOCLOCK"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_MULTIPLIER"] = Request.Post["PROCESSOR_MULTIPLIER"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_VOLTAGE"] = Request.Post["PROCESSOR_VOLTAGE"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_TDP"] = Request.Post["PROCESSOR_TDP"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_CODENAME"] = Request.Post["PROCESSOR_CODENAME"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_PART"] = Request.Post["PROCESSOR_PART"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_PRODUCTION_STATUS"] = Request.Post["PROCESSOR_PRODUCTION_STATUS"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_RELEASED"] = Request.Post["PROCESSOR_RELEASED"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_MEMORYSUPPORT"] = Request.Post["PROCESSOR_MEMORYSUPPORT"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_OFCORES"] = Request.Post["PROCESSOR_OFCORES"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_SMPCPUS"] = Request.Post["PROCESSOR_SMPCPUS"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_INTEGRATEDGRAPHIC"] = Request.Post["PROCESSOR_INTEGRATEDGRAPHIC"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_CACHEL1"] = Request.Post["PROCESSOR_CACHEL1"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_CACHEL2"] = Request.Post["PROCESSOR_CACHEL2"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_CACHEL3"] = Request.Post["PROCESSOR_CACHEL3"]
  CPUDBATOM["DATABASE"][ID]["PROCESSOR_MARKET"] = Request.Post["PROCESSOR_MARKET"]
  
  File.Save(Global.WHEREIS_SITE_ROOT & "/CPUDB/atom", JSON.Encode(CPUDBATOM))
  
  Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root & "?cpudb[atom]edit=" & ID & "")
  Else
    Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root)
  Endif
End
