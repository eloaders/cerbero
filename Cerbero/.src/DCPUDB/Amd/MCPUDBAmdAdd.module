' Gambas module file

Public Sub Add()
  Dim CPUDBAMD As Collection
  Dim CPUDBAMDADD As Collection = [("VALD"): (Rnd(200))]
  If Usera.User_Logged() = True And Usera.User_IsAdmin() = True Then
  CPUDBAMD = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/CPUDB/amd"))
  
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_MODEL_NAME"], "PROCESSOR_MODEL_NAME")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_SOCKET_IMAGE"], "PROCESSOR_SOCKET_IMAGE")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_SOCKET"], "PROCESSOR_SOCKET")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_PROCESS_SIZE"], "PROCESSOR_PROCESS_SIZE")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_TRANSISTORS"], "PROCESSOR_TRANSISTORS")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_DIE_SIZE"], "PROCESSOR_DIE_SIZE")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_PACKAGE"], "PROCESSOR_PACKAGE")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_TCASEMAX"], "PROCESSOR_TCASEMAX")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_FREQUENCY"], "PROCESSOR_FREQUENCY")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_TURBOCLOCK"], "PROCESSOR_TURBOCLOCK")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_MULTIPLIER"], "PROCESSOR_MULTIPLIER")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_VOLTAGE"], "PROCESSOR_VOLTAGE")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_TDP"], "PROCESSOR_TDP")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_CODENAME"], "PROCESSOR_CODENAME")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_PART"], "PROCESSOR_PART")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_PRODUCTION_STATUS"], "PROCESSOR_PRODUCTION_STATUS")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_RELEASED"], "PROCESSOR_RELEASED")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_MEMORYSUPPORT"], "PROCESSOR_MEMORYSUPPORT")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_OFCORES"], "PROCESSOR_OFCORES")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_SMPCPUS"], "PROCESSOR_SMPCPUS")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_INTEGRATEDGRAPHIC"], "PROCESSOR_INTEGRATEDGRAPHIC")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_CACHEL1"], "PROCESSOR_CACHEL1")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_CACHEL2"], "PROCESSOR_CACHEL2")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_CACHEL3"], "PROCESSOR_CACHEL3")
  CPUDBAMDADD.Add(Request.Post["PROCESSOR_MARKET"], "PROCESSOR_MARKET")
  CPUDBAMDADD.Remove("VALD")
  CPUDBAMD["DATABASE"].Add(CPUDBAMDADD)
  
  File.Save(Global.WHEREIS_SITE_ROOT & "/CPUDB/amd", JSON.Encode(CPUDBAMD))
  Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root & "?cpudb[amd]edit=" & CString(CPUDBAMD["DATABASE"].Count - 1) & "")
  Else
    Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root)
  Endif
  
End
