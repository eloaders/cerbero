' Gambas module file

Public Sub Add()
  Dim CPUDBINTEL As Collection
  Dim CPUDBINTELADD As Collection = [("VALD"): (Rnd(200))]
  If Usera.User_Logged() = True And Usera.User_IsAdmin() = True Then
  CPUDBINTEL = JSON.Decode(File.Load(Global.WHEREIS_SITE_ROOT & "/CPUDB/intel"))
  
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_MODEL_NAME"], "PROCESSOR_MODEL_NAME")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_SOCKET_IMAGE"], "PROCESSOR_SOCKET_IMAGE")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_SOCKET"], "PROCESSOR_SOCKET")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_PROCESS_SIZE"], "PROCESSOR_PROCESS_SIZE")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_TRANSISTORS"], "PROCESSOR_TRANSISTORS")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_DIE_SIZE"], "PROCESSOR_DIE_SIZE")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_PACKAGE"], "PROCESSOR_PACKAGE")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_TCASEMAX"], "PROCESSOR_TCASEMAX")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_FREQUENCY"], "PROCESSOR_FREQUENCY")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_TURBOCLOCK"], "PROCESSOR_TURBOCLOCK")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_MULTIPLIER"], "PROCESSOR_MULTIPLIER")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_VOLTAGE"], "PROCESSOR_VOLTAGE")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_TDP"], "PROCESSOR_TDP")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_CODENAME"], "PROCESSOR_CODENAME")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_PART"], "PROCESSOR_PART")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_PRODUCTION_STATUS"], "PROCESSOR_PRODUCTION_STATUS")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_RELEASED"], "PROCESSOR_RELEASED")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_MEMORYSUPPORT"], "PROCESSOR_MEMORYSUPPORT")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_OFCORES"], "PROCESSOR_OFCORES")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_SMPCPUS"], "PROCESSOR_SMPCPUS")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_INTEGRATEDGRAPHIC"], "PROCESSOR_INTEGRATEDGRAPHIC")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_CACHEL1"], "PROCESSOR_CACHEL1")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_CACHEL2"], "PROCESSOR_CACHEL2")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_CACHEL3"], "PROCESSOR_CACHEL3")
  CPUDBINTELADD.Add(Request.Post["PROCESSOR_MARKET"], "PROCESSOR_MARKET")
  CPUDBINTELADD.Remove("VALD")
  CPUDBINTEL["DATABASE"].Add(CPUDBINTELADD)
  
  File.Save(Global.WHEREIS_SITE_ROOT & "/CPUDB/intel", JSON.Encode(CPUDBINTEL))
  Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root & "?cpudb[intel]edit=" & CString(CPUDBINTEL["DATABASE"].Count - 1) & "")
  Else
    Response.Redirect(Global.WEBSITE_ROOT_URL_HTTP & Application.Root)
  Endif
  
End
