' Gambas module file

Public Sub Main()
Settings["W/W"] = 11
If CGI["HTTP_ACCEPT_LANGUAGE"] Like "*ru*" Then
  System.Language = "ru_RU.UTF-8"
Endif
If CGI["HTTP_ACCEPT_LANGUAGE"] Like "*pl*" Then
  System.Language = "pl_PL.UTF-8"
Endif
If CGI["HTTP_ACCEPT_LANGUAGE"] Like "*fr*" Then
  System.Language = "fr_FR.UTF-8"
Endif

If Request.Get["js"] = "whcookies.js" Then
  WCookies.Render
Else If Request.Get.Exist("signin") = True Then
  Signs.Sign_in()
Else If Request.Get.Exist("updprofile") = True Then
  CHGProfileDetails.CHProf()
Else If Request.Get.Exist("page") = True Then
  Page.Pages()
Else If Request.Post.Exist("uploadfile") = True Then
  Upload.SendFileToServer()
Else If Request.Get.Exist("validate") = True Then
  MValidate.PrintValidateData()
Else If Request.Get.Exist("fail") = True Then
  PrintFail()
Else If Request.Get.Exist("added") = True Then
  MLatestAdded.Added()
Else If Request.Get.Exist("signup") = True Then
  Signup.Signup()
Else If Request.Get.Exist("login") = True Then
  login.Sign()
Else If Request.Get.Exist("register") = True Then
  Register.Register()
Else If Request.Get.Exist("logout") = True Then
  logout.Remove_Cook()
Else If Request.Get.Exist("profile") = True Then
  Profile.User_Profile()
Else If Request.Get.Exist("chgapi") = True Then
  ChangeAPI_KEYS.CHKeys()
Else If Request.Get.Exist("test") = True Then
  Response.AddHeader("Content-Disposition", "attachment; filename=14.0309370877082.png")
  Response.SendFile("/var/www/ValidScr/04072014/14.0309370877082.png", "image/png")
Else If Request.Get.Exist("delvalidate") = True Then
  DelValidate.Delete()
Else If Request.Get.Exist("query") = True Then
  MQuery.Main()
Else If Request.Get.Exist("padm") = True And Usera.User_IsAdmin() = True Then
  WAdminPanel.Render
Else If Request.Get.Exist("cpudb[atom]") = True Then
  Response.Begin
  WCPUDBAtom.Render
  Response.End
Else If Request.Get.Exist("cpudb[atom]edit") = True Then
  WCPUDBAtomEdit.Render
Else If Request.Get.Exist("downloadcount") = True Then
MDownload.Main()
Response.Redirect("http://127.0.0.1/")

Else If Request.Get.Exist("downloadcountr") = True Then
  Response.Begin
  Print MDownload.DownloadCount()
  Response.End
Else
  ResponseFromServer()
Endif
End

Public Sub ResponseFromServer()
  MBrand.Brand_URL = Global.WEBSITE_ROOT_URL_HTTP & Application.Root
  MBrand.Brand_TEXT = "I-Nex - Cerbero"
  Response.Begin
    Print "<!DOCTYPE html>"
    Print "<html lang=\"en\">"
    WHead.Render
    Print "<body>"
    WNavbar.Render
    DUpload.Render
  Response.End
  
End

Public Sub PrintFail()
  
  Response.Begin
  Print File.Load("Error/NotFoundValidateID.html")
  Response.End
  
End

